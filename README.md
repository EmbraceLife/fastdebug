fastdebug
================

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

``` python
from IPython.display import display, HTML
```

``` python
display(HTML("<style>.container { width:100% !important; }</style>"))
```

<style>.container { width:100% !important; }</style>

## References I use when I explore

### fastai style

What is the fastai coding
[style](https://docs.fast.ai/dev/style.html#style-guide)

How to do [abbreviation](https://docs.fast.ai/dev/abbr.html) the fastai
way

A great example of how fastai libraries can make life more
[comfortable](https://www.fast.ai/2019/08/06/delegation/)

## What is the motivation behind `fastdebug` library?

Please let me show you with a simple example here.

I have always wanted to explore the wonderful fastai libraries (I am
starting with fastcore). I like to learn the fastai coding style,
exploratory coding approach in jupyter and of course all the knowledge
Jeremy distilled in the fastai libraries :). Even though every fastai
function or class is quite short, but for a novice like me every library
looks massive. To really make sense of what each line does is certainly
a daunting task. So, is it possible to explore the libraries efficiently
and joyfully?

Are there any nice tools out there can help me explore and even document
my learnings along the way? Yes, they are jupyter notebook/lab and ipdb
(or visual debugger). However, ipdb and visual debugger felt clunky to
me for my exploration and documentation purpose.

Therefore, I decided to write a little tool (it becomes fastdebug) to
allow me explore and document fastai libraries with ease and joy. Of
course, as a beginner I would not dare to try writing a library without
the wonderful [nbdev](https://nbdev.fast.ai/) and the amazing team
behind it.

As you should know now, this lib does two things: explore and document
source code. Let’s start with
[`Fastdb.explore`](https://EmbraceLife.github.io/fastdebug/core.html#fastdb.explore)
first on a simple example. If you would like to see it working on a more
complex real world example, I have
[`fastcore.meta.FixSigMeta`](https://fastcore.fast.ai/meta.html#fixsigmeta)
[ready](./FixSigMeta.ipynb) for you.

If you find anything confusing or bug-like, please inform me in this
forum [post](https://forums.fast.ai/t/hidden-docs-of-fastcore/98455).

## [`Fastdb.explore`](https://EmbraceLife.github.io/fastdebug/core.html#fastdb.explore)

### Why not explore with pure `ipdb.set_trace`?

[`Fastdb.explore`](https://EmbraceLife.github.io/fastdebug/core.html#fastdb.explore)
is a wrapper around `ipdb.set_trace` and make my life easier when I am
exploring because:

> I don’t need to write `from ipdb import set_trace` for every notebook

> I don’t need to manually open the source code file and scroll down the
> source code

> I don’t need to insert `set_trace()` above every line of source code
> (srcline) I want to start exploring

> I don’t need to remove `set_trace()` from the source code every time
> after exploration

### How to [`Fastdb.explore`](https://EmbraceLife.github.io/fastdebug/core.html#fastdb.explore)?

Let’s explore the source code of
[`whatinside`](https://EmbraceLife.github.io/fastdebug/utils.html#whatinside)
from `fastdebug.utils` using this tool.

``` python
from fastdebug.utils import * # for making an example 
import fastdebug.utils as fu # for making an example 
from fastcore.test import * 
import inspect
```

``` python
whatinside(fu) # this is the example we are going to explore whatinside with
```

    fastdebug.utils has: 
    3 items in its __all__, and 
    8 user defined functions, 
    0 classes or class objects, 
    0 builtin funcs and methods, and
    8 callables.

``` python
from fastdebug.core import * # Let's import Fastdb and its dependencies
```

``` python
fdb = Fastdb(whatinside) # first, create an object of Fastdb class, using `whatinside` as param
```

``` python
# 1. you can view source code in whole or in parts with the length you set, 
# and it gives you srcline idx so that you can set breakpoint with ease.
fdb.print(20,1)
```

    def whatinside(mo, # module, e.g., `import fastcore.all as fa`, use `fa` here=============(0)       
                   dun:bool=False, # print all items in __all__===============================(1)       
                   func:bool=False, # print all user defined functions========================(2)       
                   clas:bool=False, # print all class objects=================================(3)       
                   bltin:bool=False, # print all builtin funcs or methods=====================(4)       
                   lib:bool=False, # print all the modules of the library it belongs to=======(5)       
                   cal:bool=False # print all callables=======================================(6)       
                 ): ==========================================================================(7)       
        'Check what inside a module: `__all__`, functions, classes, builtins, and callables'==(8)       
        dun_all = len(mo.__all__) if hasattr(mo, "__all__") else 0============================(9)       
        funcs = inspect.getmembers(mo, inspect.isfunction)====================================(10)      
        classes = inspect.getmembers(mo, inspect.isclass)=====================================(11)      
        builtins = inspect.getmembers(mo, inspect.isbuiltin)==================================(12)      
        callables = inspect.getmembers(mo, callable)==========================================(13)      
        pkgpath = os.path.dirname(mo.__file__)================================================(14)      
        print(f"{mo.__name__} has: \n{dun_all} items in its __all__, and \n{len(funcs)} user defined functions, \n{len(classes)} classes or class objects, \n{len(builtins)} builtin funcs and methods, and\n{len(callables)} callables.\n")  (15)
        if hasattr(mo, "__all__") and dun: pprint(mo.__all__)=================================(16)      
        if func: =============================================================================(17)      
            print(f'The user defined functions are:')=========================================(18)      
            pprint([i[0] for i in funcs])=====================================================(19)      
                                                                                                                                         part No.1 out of 2 parts

``` python
test_eq(inspect.getsourcefile(whatinside), "/Users/Natsume/Documents/fastdebug/fastdebug/utils.py")
test_eq(inspect.getsourcefile(fu.whatinside), "/Users/Natsume/Documents/fastdebug/fastdebug/utils.py")
```

``` python
# 2. after viewing source code, choose a srcline idx to set breakpoint and write down why I want to explore this line
fdb.explore([11, 16, 13], "what is getmembers", showdbsrc=True)
```

    print selected srcline with expands above----------
    print out dbsrc------------------------------------
    def whatinside(mo, # module, e.g., `import fastcore.all as fa`, use `fa` here---------------------------------------------------------------------------(0)
                   dun:bool=False, # print all items in __all__---------------------------------------------------------------------------------------------(1)
                   func:bool=False, # print all user defined functions--------------------------------------------------------------------------------------(2)
                   clas:bool=False, # print all class objects-----------------------------------------------------------------------------------------------(3)
                   bltin:bool=False, # print all builtin funcs or methods-----------------------------------------------------------------------------------(4)
                   lib:bool=False, # print all the modules of the library it belongs to---------------------------------------------------------------------(5)
                   cal:bool=False # print all callables-----------------------------------------------------------------------------------------------------(6)
                 ): ----------------------------------------------------------------------------------------------------------------------------------------(7)
        'Check what inside a module: `__all__`, functions, classes, builtins, and callables'----------------------------------------------------------------(8)
        dun_all = len(mo.__all__) if hasattr(mo, "__all__") else 0------------------------------------------------------------------------------------------(9)
        funcs = inspect.getmembers(mo, inspect.isfunction)--------------------------------------------------------------------------------------------------(10)
        import ipdb; ipdb.set_trace()=======================================================================================================================(db)
        classes = inspect.getmembers(mo, inspect.isclass)---------------------------------------------------------------------------------------------------(11)
        builtins = inspect.getmembers(mo, inspect.isbuiltin)------------------------------------------------------------------------------------------------(12)
        import ipdb; ipdb.set_trace()=======================================================================================================================(db)
        callables = inspect.getmembers(mo, callable)--------------------------------------------------------------------------------------------------------(13)
        pkgpath = os.path.dirname(mo.__file__)--------------------------------------------------------------------------------------------------------------(14)
        print(f"{mo.__name__} has: \n{dun_all} items in its __all__, and \n{len(funcs)} user defined functions, \n{len(classes)} classes or class objects, \n{len(builtins)} builtin funcs and methods, and\n{len(callables)} callables.\n")  (15)
        import ipdb; ipdb.set_trace()=======================================================================================================================(db)
        if hasattr(mo, "__all__") and dun: pprint(mo.__all__)-----------------------------------------------------------------------------------------------(16)
        if func: -------------------------------------------------------------------------------------------------------------------------------------------(17)
            print(f'The user defined functions are:')-------------------------------------------------------------------------------------------------------(18)
            pprint([i[0] for i in funcs])-------------------------------------------------------------------------------------------------------------------(19)
        if clas: -------------------------------------------------------------------------------------------------------------------------------------------(20)
            print(f'The class objects are:')----------------------------------------------------------------------------------------------------------------(21)
            pprint([i[0] for i in classes])-----------------------------------------------------------------------------------------------------------------(22)
        if bltin: ------------------------------------------------------------------------------------------------------------------------------------------(23)
            print(f'The builtin functions or methods are:')-------------------------------------------------------------------------------------------------(24)
            pprint([i[0] for i in builtins])----------------------------------------------------------------------------------------------------------------(25)
        if cal: --------------------------------------------------------------------------------------------------------------------------------------------(26)
            print(f'The callables are: ')-------------------------------------------------------------------------------------------------------------------(27)
            pprint([i[0] for i in callables])---------------------------------------------------------------------------------------------------------------(28)
        if lib: --------------------------------------------------------------------------------------------------------------------------------------------(29)
            modules = [name for _, name, _ in pkgutil.iter_modules([pkgpath])]------------------------------------------------------------------------------(30)
            print(f'The library has {len(modules)} modules')------------------------------------------------------------------------------------------------(31)
            pprint(modules)---------------------------------------------------------------------------------------------------------------------------------(32)
    exec on dbsrc above--------------------------------
    locals() keys: ['self', 'idxsrc', 'cmt', 'showdbsrc', 'src', 'dbsrc', 'indent', 'lst', 'srclines', 'idxlst', 'idx', 'l', 'numindent', 'dbcodes', 'totallen', 'lenidx', 'dblst', 'idxsrcline', 'idxcount', 'lenl', 'names', 'file_name', 'f', 'code', 'whatinside']
    self.orisrc.__name__: whatinside
    locals()['whatinside']: <function whatinside at 0x103fb3af0>
    after exec and before self.outenv update, self.outenv['whatinside'] is locals()['whatinside']: False
    after exec and before self.outenv update, self.orisrc.__name__: whatinside is self.outenv['whatinside']: True
    after exec and before self.outenv update, self.orisrc.__name__: whatinside is locals()['whatinside']: False
    after update self.outenv, self.orisrc.__name__: whatinside is self.outenv['whatinside']: False
    after update self.outenv, self.orisrc.__name__: whatinside is fastdebug.utils.whatinside: False
    after update self.outenv, self.outenv['whatinside'] is fastdebug.utils.whatinside: True
    Therefore, to use dbsrc we must use self.outenv['whatinside'], or fastdebug.utils.whatinside
    showdbsrc=End--------------------------------------

``` python
# 2. you can set multiple breakpoints from the start if you like (but not necessary)
fdb.explore([11, 16, 13], "what is getmembers", showdbsrc=True)
```

``` python
test_eq(inspect.getsourcefile(whatinside), "/Users/Natsume/Documents/fastdebug/fastdebug/utils.py")
test_eq(inspect.getsourcefile(fu.whatinside), "/tmp/whatinside.py") # this is the actual source file we are exploring, 
# so we are using fu.whatinside, not whatinside to run examples
```

``` python
fu.whatinside(fu) # 3. ipdb initiated on the breakpoint
```

    <function save_history at 0x103f195e0>
    *** SyntaxError: EOF while scanning triple-quoted string literal
    *** SyntaxError: invalid syntax
    *** SyntaxError: unmatched ')'
    *** SyntaxError: invalid syntax
    *** SyntaxError: EOF while scanning triple-quoted string literal
    *** IndentationError: expected an indented block
    *** AttributeError: module 'pdb' has no attribute 'Color'
    *** AttributeError: module 'pdb' has no attribute 'Color'
    *** AttributeError: module 'pdb' has no attribute 'Color'
    > /tmp/whatinside.py(13)whatinside()
         12     import ipdb; ipdb.set_trace()
    ---> 13     classes = inspect.getmembers(mo, inspect.isclass)
         14     builtins = inspect.getmembers(mo, inspect.isbuiltin)

    ipdb> q

``` python
fdb.goback() # when you done exploring, return everything back to normal.
```

``` python
test_eq(inspect.getsourcefile(whatinside), "/Users/Natsume/Documents/fastdebug/fastdebug/utils.py")
test_eq(inspect.getsourcefile(fu.whatinside), "/Users/Natsume/Documents/fastdebug/fastdebug/utils.py")
```

## [`Fastdb.dbprint`](https://EmbraceLife.github.io/fastdebug/core.html#fastdb.dbprint)

After exploration, if you realize there is something new to learn and
maybe want to come back for a second look, you will find `ipdb` and the
alike are not designed to document your learning. Here comes `dbprint`
to make my life easier because:

> I won’t need to scroll through a long cell output of pdb commands, src
> prints and results to find what I learnt during exploration

> I won’t need to type all the expressions during last exploration to
> regenerate the findings for me

> I can choose any srclines to explore and write any sinlge or
> multi-line expressions to evaluate the srcline

> I can write down what I learn or what is new on any srcline as comment
> attached to the src code

> All expressions with results and comments for each srcline under
> exploration are documented for easy reviews

> Of course, no worry about your original source code, as it is
> untouched.

I would like to do is to read the source code, but I would like to have
each line indiced so that I can specify exactly which line to dig into
later.

### Step 0: get the globals of the source code before exploration

We are exploring
[`whatinside`](https://EmbraceLife.github.io/fastdebug/utils.html#whatinside),
so we need to have the env (see `g` below) where it is defined for
[`Fastdb`](https://EmbraceLife.github.io/fastdebug/core.html#fastdb) to
use.

``` python
test_eq(whatinside is fu.whatinside, True)
test_eq(whatinside is whatinside.__globals__['whatinside'], True)
test_eq(fu.whatinside is whatinside.__globals__['whatinside'], True)
```

### Step 1: display the source code with idx

``` python
from fastdebug.core import *
```

``` python
# both whatinside and fu.whatinside are the same here, don't matter which
# fdb = Fastdb(whatinside) # g is refactored inside Fastdb
fdb = Fastdb(fu.whatinside)
```

``` python
fdb.print()
```

    def whatinside(mo, # module, e.g., `import fastcore.all as fa`, use `fa` here=============(0)       
                   dun:bool=False, # print all items in __all__===============================(1)       
                   func:bool=False, # print all user defined functions========================(2)       
                   clas:bool=False, # print all class objects=================================(3)       
                   bltin:bool=False, # print all builtin funcs or methods=====================(4)       
                   lib:bool=False, # print all the modules of the library it belongs to=======(5)       
                   cal:bool=False # print all callables=======================================(6)       
                 ): ==========================================================================(7)       
        'Check what inside a module: `__all__`, functions, classes, builtins, and callables'==(8)       
        dun_all = len(mo.__all__) if hasattr(mo, "__all__") else 0============================(9)       
        funcs = inspect.getmembers(mo, inspect.isfunction)====================================(10)      
        classes = inspect.getmembers(mo, inspect.isclass)=====================================(11)      
        builtins = inspect.getmembers(mo, inspect.isbuiltin)==================================(12)      
        callables = inspect.getmembers(mo, callable)==========================================(13)      
        pkgpath = os.path.dirname(mo.__file__)================================================(14)      
        print(f"{mo.__name__} has: \n{dun_all} items in its __all__, and \n{len(funcs)} user defined functions, \n{len(classes)} classes or class objects, \n{len(builtins)} builtin funcs and methods, and\n{len(callables)} callables.\n")  (15)
        if hasattr(mo, "__all__") and dun: pprint(mo.__all__)=================================(16)      
        if func: =============================================================================(17)      
            print(f'The user defined functions are:')=========================================(18)      
            pprint([i[0] for i in funcs])=====================================================(19)      
        if clas: =============================================================================(20)      
            print(f'The class objects are:')==================================================(21)      
            pprint([i[0] for i in classes])===================================================(22)      
        if bltin: ============================================================================(23)      
            print(f'The builtin functions or methods are:')===================================(24)      
            pprint([i[0] for i in builtins])==================================================(25)      
        if cal: ==============================================================================(26)      
            print(f'The callables are: ')=====================================================(27)      
            pprint([i[0] for i in callables])=================================================(28)      
        if lib: ==============================================================================(29)      
            modules = [name for _, name, _ in pkgutil.iter_modules([pkgpath])]================(30)      
            print(f'The library has {len(modules)} modules')==================================(31)      
            pprint(modules)===================================================================(32)      
                                                                                                                                                            (33)

### Step 2: exploring, evaluating, and commenting as I like

I usually write a question for exploration as comment, and after
exploration I will replace it with a better summary.

``` python
fdb.dbprint(9, "count num in __all__", showdbsrc=True)
fdb.print(maxlines=15, part=1)
```

                 ):                                                                                                                                         (7)
        'Check what inside a module: `__all__`, functions, classes, builtins, and callables'                                                                (8)
        dun_all = len(mo.__all__) if hasattr(mo, "__all__") else 0==========================================================================================(9)
                                                                                                                                             count num in __all__
        funcs = inspect.getmembers(mo, inspect.isfunction)                                                                                                  (10)
        classes = inspect.getmembers(mo, inspect.isclass)                                                                                                   (11)
    print selected srcline with expands above----------
    showdbsrc=Start------------------------------------
    def whatinside(mo, # module, e.g., `import fastcore.all as fa`, use `fa` here---------------------------------------------------------------------------(0)
                   dun:bool=False, # print all items in __all__---------------------------------------------------------------------------------------------(1)
                   func:bool=False, # print all user defined functions--------------------------------------------------------------------------------------(2)
                   clas:bool=False, # print all class objects-----------------------------------------------------------------------------------------------(3)
                   bltin:bool=False, # print all builtin funcs or methods-----------------------------------------------------------------------------------(4)
                   lib:bool=False, # print all the modules of the library it belongs to---------------------------------------------------------------------(5)
                   cal:bool=False # print all callables-----------------------------------------------------------------------------------------------------(6)
                 ): ----------------------------------------------------------------------------------------------------------------------------------------(7)
        'Check what inside a module: `__all__`, functions, classes, builtins, and callables'----------------------------------------------------------------(8)
        dun_all = len(mo.__all__) if hasattr(mo, "__all__") else 0------------------------------------------------------------------------------------------(9)
        funcs = inspect.getmembers(mo, inspect.isfunction)--------------------------------------------------------------------------------------------------(10)
        classes = inspect.getmembers(mo, inspect.isclass)---------------------------------------------------------------------------------------------------(11)
        builtins = inspect.getmembers(mo, inspect.isbuiltin)------------------------------------------------------------------------------------------------(12)
        callables = inspect.getmembers(mo, callable)--------------------------------------------------------------------------------------------------------(13)
        pkgpath = os.path.dirname(mo.__file__)--------------------------------------------------------------------------------------------------------------(14)
        print(f"{mo.__name__} has: \n{dun_all} items in its __all__, and \n{len(funcs)} user defined functions, \n{len(classes)} classes or class objects, \n{len(builtins)} builtin funcs and methods, and\n{len(callables)} callables.\n")  (15)
        if hasattr(mo, "__all__") and dun: pprint(mo.__all__)-----------------------------------------------------------------------------------------------(16)
        if func: -------------------------------------------------------------------------------------------------------------------------------------------(17)
            print(f'The user defined functions are:')-------------------------------------------------------------------------------------------------------(18)
            pprint([i[0] for i in funcs])-------------------------------------------------------------------------------------------------------------------(19)
        if clas: -------------------------------------------------------------------------------------------------------------------------------------------(20)
            print(f'The class objects are:')----------------------------------------------------------------------------------------------------------------(21)
            pprint([i[0] for i in classes])-----------------------------------------------------------------------------------------------------------------(22)
        if bltin: ------------------------------------------------------------------------------------------------------------------------------------------(23)
            print(f'The builtin functions or methods are:')-------------------------------------------------------------------------------------------------(24)
            pprint([i[0] for i in builtins])----------------------------------------------------------------------------------------------------------------(25)
        if cal: --------------------------------------------------------------------------------------------------------------------------------------------(26)
            print(f'The callables are: ')-------------------------------------------------------------------------------------------------------------------(27)
            pprint([i[0] for i in callables])---------------------------------------------------------------------------------------------------------------(28)
        if lib: --------------------------------------------------------------------------------------------------------------------------------------------(29)
            modules = [name for _, name, _ in pkgutil.iter_modules([pkgpath])]------------------------------------------------------------------------------(30)
            print(f'The library has {len(modules)} modules')------------------------------------------------------------------------------------------------(31)
            pprint(modules)---------------------------------------------------------------------------------------------------------------------------------(32)
    locals() keys: ['self', 'idxsrc', 'cmt', 'expand', 'showdbsrc', 'codes', 'src', 'dbsrc', 'indent', 'lst', 'newlst', 'srclines', 'idx', 'l', 'totallen', 'lenidx', 'dblst', 'idxsrcline', 'lenl']
    before update to exec, self.orisrc.__name__: whatinside is self.outenv['whatinside']: True
    exec on dbsrc above--------------------------------
    locals() keys: ['self', 'idxsrc', 'cmt', 'expand', 'showdbsrc', 'codes', 'src', 'dbsrc', 'indent', 'lst', 'newlst', 'srclines', 'idx', 'l', 'totallen', 'lenidx', 'dblst', 'idxsrcline', 'lenl', 'names', 'whatinside']
    self.orisrc.__name__: whatinside
    locals()['whatinside']: <function whatinside at 0x103fd71f0>
    after exec and before self.outenv update, self.outenv['whatinside'] is locals()['whatinside']: False
    after exec and before self.outenv update, self.orisrc.__name__: whatinside is self.outenv['whatinside']: True
    after exec and before self.outenv update, self.orisrc.__name__: whatinside is locals()['whatinside']: False
    after update self.outenv, self.orisrc.__name__: whatinside is self.outenv['whatinside']: False
    after update self.outenv, self.orisrc.__name__: whatinside is fastdebug.utils.whatinside: False
    after update self.outenv, self.outenv['whatinside'] is fastdebug.utils.whatinside: True
    Therefore, to use dbsrc we must use self.outenv['whatinside'], or fastdebug.utils.whatinside
    showdbsrc=End--------------------------------------
    def whatinside(mo, # module, e.g., `import fastcore.all as fa`, use `fa` here=============(0)       
                   dun:bool=False, # print all items in __all__===============================(1)       
                   func:bool=False, # print all user defined functions========================(2)       
                   clas:bool=False, # print all class objects=================================(3)       
                   bltin:bool=False, # print all builtin funcs or methods=====================(4)       
                   lib:bool=False, # print all the modules of the library it belongs to=======(5)       
                   cal:bool=False # print all callables=======================================(6)       
                 ): ==========================================================================(7)       
        'Check what inside a module: `__all__`, functions, classes, builtins, and callables'==(8)       
        dun_all = len(mo.__all__) if hasattr(mo, "__all__") else 0============================(9) # count num in __all__
        funcs = inspect.getmembers(mo, inspect.isfunction)====================================(10)      
        classes = inspect.getmembers(mo, inspect.isclass)=====================================(11)      
        builtins = inspect.getmembers(mo, inspect.isbuiltin)==================================(12)      
        callables = inspect.getmembers(mo, callable)==========================================(13)      
        pkgpath = os.path.dirname(mo.__file__)================================================(14)      
                                                                                                                                         part No.1 out of 2 parts

line 9 looks easy enough, but line 10 is unfamiliar to me, so I would
like to explore and dig around it.

Here are a list of things I want to ask about this line of code

1.  what is `mo`? (easy)
2.  what does `inspect.isfunction` do?
3.  what does `inspect.getmembers` do?
4.  what does `funcs = inspect.getmembers(mo, inspect.isfunction)` give
    me?

I want to find out about them without searching online, nor using
running separate cells to be deleted later.

``` python
dbsrc = fdb.dbprint(10, "get all funcs of a module", "mo", "inspect.getdoc(inspect.isfunction)", \
            "inspect.getdoc(inspect.getmembers)", "funcs = inspect.getmembers(mo, inspect.isfunction)")
fu.whatinside(fu)
```

        'Check what inside a module: `__all__`, functions, classes, builtins, and callables'                                                                (8)
        dun_all = len(mo.__all__) if hasattr(mo, "__all__") else 0                                                                                          (9)
        funcs = inspect.getmembers(mo, inspect.isfunction)==================================================================================================(10)
                                                                                                                                        get all funcs of a module
        classes = inspect.getmembers(mo, inspect.isclass)                                                                                                   (11)
        builtins = inspect.getmembers(mo, inspect.isbuiltin)                                                                                                (12)


                                                               mo => mo : <module 'fastdebug.utils' from '/Users/Natsume/Documents/fastdebug/fastdebug/utils.py'>


    inspect.getdoc(inspect.isfunction) => inspect.getdoc(inspect.isfunction) : Return true if the object is a user-defined function.

    Function objects provide these attributes:
        __doc__         documentation string
        __name__        name with which this function was defined
        __code__        code object containing compiled function bytecode
        __defaults__    tuple of any default values for arguments
        __globals__     global namespace in which this function was defined
        __annotations__ dict of parameter annotations
        __kwdefaults__  dict of keyword only parameters with defaults


    inspect.getdoc(inspect.getmembers) => inspect.getdoc(inspect.getmembers) : Return all members of an object as (name, value) pairs sorted by name.
    Optionally, only return members that satisfy a given predicate.


    funcs = inspect.getmembers(mo, inspect.isfunction) => funcs: [('distribution', <function distribution at 0x103f5d310>), ('metadata', <function metadata at 0x103f78040>), ('pprint', <function pprint at 0x101ebf3a0>), ('python_version', <function python_version at 0x1017f0040>), ('src', <function whatinside at 0x103f5d0d0>), ('tstenv', <function tstenv at 0x103f5d3a0>), ('version', <function version at 0x103f780d0>), ('whatinside', <function whatinside at 0x103fb3c10>), ('whichversion', <function whichversion at 0x103f5d1f0>)]
    fastdebug.utils has: 
    3 items in its __all__, and 
    9 user defined functions, 
    0 classes or class objects, 
    0 builtin funcs and methods, and
    9 callables.

Intesting and unexpected: something interesting and unexpected things
discovered above for myself is the attributes of a function

If you want to zoom in the source code, you could cut the source into
parts and exam each part individually.

``` python
fdb.print(maxlines=15, part=1)
```

    def whatinside(mo, # module, e.g., `import fastcore.all as fa`, use `fa` here=============(0)       
                   dun:bool=False, # print all items in __all__===============================(1)       
                   func:bool=False, # print all user defined functions========================(2)       
                   clas:bool=False, # print all class objects=================================(3)       
                   bltin:bool=False, # print all builtin funcs or methods=====================(4)       
                   lib:bool=False, # print all the modules of the library it belongs to=======(5)       
                   cal:bool=False # print all callables=======================================(6)       
                 ): ==========================================================================(7)       
        'Check what inside a module: `__all__`, functions, classes, builtins, and callables'==(8)       
        dun_all = len(mo.__all__) if hasattr(mo, "__all__") else 0============================(9) # count num in __all__
        funcs = inspect.getmembers(mo, inspect.isfunction)====================================(10) # get all funcs of a module
        classes = inspect.getmembers(mo, inspect.isclass)=====================================(11)      
        builtins = inspect.getmembers(mo, inspect.isbuiltin)==================================(12)      
        callables = inspect.getmembers(mo, callable)==========================================(13)      
        pkgpath = os.path.dirname(mo.__file__)================================================(14)      
                                                                                                                                         part No.1 out of 2 parts

You may find the `funcs` difficult to read, if so you can write a block
of codes to print out the `funcs` nicely.

``` python
dbsrc = fdb.dbprint(11, "get all classes from the module", \
"clas = inspect.getmembers(mo, inspect.isclass)\\n\
for c in clas:\\n\
    print(c)")
fu.whatinside(fu)
fdb.print(maxlines=15, part=1)
```

        dun_all = len(mo.__all__) if hasattr(mo, "__all__") else 0                                                                                          (9)
        funcs = inspect.getmembers(mo, inspect.isfunction)                                                                                                  (10)
        classes = inspect.getmembers(mo, inspect.isclass)===================================================================================================(11)
                                                                                                                                  get all classes from the module
        builtins = inspect.getmembers(mo, inspect.isbuiltin)                                                                                                (12)
        callables = inspect.getmembers(mo, callable)                                                                                                        (13)


    clas = inspect.getmembers(mo, inspect.isclass)
    for c in clas:
        print(c)                                                                                   
                                                                                                                                      Running your code block => 
    The code block printout => : 
    fastdebug.utils has: 
    3 items in its __all__, and 
    9 user defined functions, 
    0 classes or class objects, 
    0 builtin funcs and methods, and
    9 callables.

    def whatinside(mo, # module, e.g., `import fastcore.all as fa`, use `fa` here=============(0)       
                   dun:bool=False, # print all items in __all__===============================(1)       
                   func:bool=False, # print all user defined functions========================(2)       
                   clas:bool=False, # print all class objects=================================(3)       
                   bltin:bool=False, # print all builtin funcs or methods=====================(4)       
                   lib:bool=False, # print all the modules of the library it belongs to=======(5)       
                   cal:bool=False # print all callables=======================================(6)       
                 ): ==========================================================================(7)       
        'Check what inside a module: `__all__`, functions, classes, builtins, and callables'==(8)       
        dun_all = len(mo.__all__) if hasattr(mo, "__all__") else 0============================(9) # count num in __all__
        funcs = inspect.getmembers(mo, inspect.isfunction)====================================(10) # get all funcs of a module
        classes = inspect.getmembers(mo, inspect.isclass)=====================================(11) # get all classes from the module
        builtins = inspect.getmembers(mo, inspect.isbuiltin)==================================(12)      
        callables = inspect.getmembers(mo, callable)==========================================(13)      
        pkgpath = os.path.dirname(mo.__file__)================================================(14)      
                                                                                                                                         part No.1 out of 2 parts

Keep reading, I want to see what exactly does line 14 do?

``` python
dbsrc = fdb.dbprint(14, "get the file path of the module", "mo.__file__", "inspect.getdoc(os.path.dirname)", "pkgpath = os.path.dirname(mo.__file__)")
fu.whatinside(fu)
fdb.print(maxlines=10, part=2)
```

        builtins = inspect.getmembers(mo, inspect.isbuiltin)                                                                                                (12)
        callables = inspect.getmembers(mo, callable)                                                                                                        (13)
        pkgpath = os.path.dirname(mo.__file__)==============================================================================================================(14)
                                                                                                                                  get the file path of the module
        print(f"{mo.__name__} has: \n{dun_all} items in its __all__, and \n{len(funcs)} user defined functions, \n{len(classes)} classes or class objects, \n{len(builtins)} builtin funcs and methods, and\n{len(callables)} callables.\n")  (15)
        if hasattr(mo, "__all__") and dun: pprint(mo.__all__)                                                                                               (16)


                                                                               mo.__file__ => mo.__file__ : /Users/Natsume/Documents/fastdebug/fastdebug/utils.py


                                               inspect.getdoc(os.path.dirname) => inspect.getdoc(os.path.dirname) : Returns the directory component of a pathname


                                                                  pkgpath = os.path.dirname(mo.__file__) => pkgpath: /Users/Natsume/Documents/fastdebug/fastdebug
    fastdebug.utils has: 
    3 items in its __all__, and 
    9 user defined functions, 
    0 classes or class objects, 
    0 builtin funcs and methods, and
    9 callables.

        funcs = inspect.getmembers(mo, inspect.isfunction)====================================(10) # get all funcs of a module
        classes = inspect.getmembers(mo, inspect.isclass)=====================================(11) # get all classes from the module
        builtins = inspect.getmembers(mo, inspect.isbuiltin)==================================(12)      
        callables = inspect.getmembers(mo, callable)==========================================(13)      
        pkgpath = os.path.dirname(mo.__file__)================================================(14) # get the file path of the module
        print(f"{mo.__name__} has: \n{dun_all} items in its __all__, and \n{len(funcs)} user defined functions, \n{len(classes)} classes or class objects, \n{len(builtins)} builtin funcs and methods, and\n{len(callables)} callables.\n")  (15)
        if hasattr(mo, "__all__") and dun: pprint(mo.__all__)=================================(16)      
        if func: =============================================================================(17)      
            print(f'The user defined functions are:')=========================================(18)      
            pprint([i[0] for i in funcs])=====================================================(19)      
                                                                                                                                         part No.2 out of 2 parts

Finally, I want to dig into line 30 with a different example to trigger
line 30.

``` python
fdb.print(maxlines=20, part=2)
```

        if clas: =============================================================================(20)      
            print(f'The class objects are:')==================================================(21)      
            pprint([i[0] for i in classes])===================================================(22)      
        if bltin: ============================================================================(23)      
            print(f'The builtin functions or methods are:')===================================(24)      
            pprint([i[0] for i in builtins])==================================================(25)      
        if cal: ==============================================================================(26)      
            print(f'The callables are: ')=====================================================(27)      
            pprint([i[0] for i in callables])=================================================(28)      
        if lib: ==============================================================================(29)      
            modules = [name for _, name, _ in pkgutil.iter_modules([pkgpath])]================(30)      
            print(f'The library has {len(modules)} modules')==================================(31)      
            pprint(modules)===================================================================(32)      
                                                                                                                                                            (33)
                                                                                                                                         part No.2 out of 2 parts

``` python
dbsrc = fdb.dbprint(30, "get names of all modules of a lib", "pkgpath", "inspect.getdoc(pkgutil.iter_modules)", \
"for a, b, c in pkgutil.iter_modules([pkgpath]):\\n\
    print(f'{a} ; {b}; {c}')", showdbsrc=True)
fu.whatinside(fu, lib=True)
fdb.print(maxlines=20, part=2)
```

            pprint([i[0] for i in callables])                                                                                                               (28)
        if lib:                                                                                                                                             (29)
            modules = [name for _, name, _ in pkgutil.iter_modules([pkgpath])]==============================================================================(30)
                                                                                                                                get names of all modules of a lib
            print(f'The library has {len(modules)} modules')                                                                                                (31)
            pprint(modules)                                                                                                                                 (32)
    print selected srcline with expands above----------
    showdbsrc=Start------------------------------------
    def whatinside(mo, # module, e.g., `import fastcore.all as fa`, use `fa` here---------------------------------------------------------------------------(0)
                   dun:bool=False, # print all items in __all__---------------------------------------------------------------------------------------------(1)
                   func:bool=False, # print all user defined functions--------------------------------------------------------------------------------------(2)
                   clas:bool=False, # print all class objects-----------------------------------------------------------------------------------------------(3)
                   bltin:bool=False, # print all builtin funcs or methods-----------------------------------------------------------------------------------(4)
                   lib:bool=False, # print all the modules of the library it belongs to---------------------------------------------------------------------(5)
                   cal:bool=False # print all callables-----------------------------------------------------------------------------------------------------(6)
                 ): ----------------------------------------------------------------------------------------------------------------------------------------(7)
        'Check what inside a module: `__all__`, functions, classes, builtins, and callables'----------------------------------------------------------------(8)
        dun_all = len(mo.__all__) if hasattr(mo, "__all__") else 0------------------------------------------------------------------------------------------(9)
        funcs = inspect.getmembers(mo, inspect.isfunction)--------------------------------------------------------------------------------------------------(10)
        classes = inspect.getmembers(mo, inspect.isclass)---------------------------------------------------------------------------------------------------(11)
        builtins = inspect.getmembers(mo, inspect.isbuiltin)------------------------------------------------------------------------------------------------(12)
        callables = inspect.getmembers(mo, callable)--------------------------------------------------------------------------------------------------------(13)
        pkgpath = os.path.dirname(mo.__file__)--------------------------------------------------------------------------------------------------------------(14)
        print(f"{mo.__name__} has: \n{dun_all} items in its __all__, and \n{len(funcs)} user defined functions, \n{len(classes)} classes or class objects, \n{len(builtins)} builtin funcs and methods, and\n{len(callables)} callables.\n")  (15)
        if hasattr(mo, "__all__") and dun: pprint(mo.__all__)-----------------------------------------------------------------------------------------------(16)
        if func: -------------------------------------------------------------------------------------------------------------------------------------------(17)
            print(f'The user defined functions are:')-------------------------------------------------------------------------------------------------------(18)
            pprint([i[0] for i in funcs])-------------------------------------------------------------------------------------------------------------------(19)
        if clas: -------------------------------------------------------------------------------------------------------------------------------------------(20)
            print(f'The class objects are:')----------------------------------------------------------------------------------------------------------------(21)
            pprint([i[0] for i in classes])-----------------------------------------------------------------------------------------------------------------(22)
        if bltin: ------------------------------------------------------------------------------------------------------------------------------------------(23)
            print(f'The builtin functions or methods are:')-------------------------------------------------------------------------------------------------(24)
            pprint([i[0] for i in builtins])----------------------------------------------------------------------------------------------------------------(25)
        if cal: --------------------------------------------------------------------------------------------------------------------------------------------(26)
            print(f'The callables are: ')-------------------------------------------------------------------------------------------------------------------(27)
            pprint([i[0] for i in callables])---------------------------------------------------------------------------------------------------------------(28)
        if lib: --------------------------------------------------------------------------------------------------------------------------------------------(29)
            g = locals()------------------------------------------------------------------------------------------------------------------------------------(30)
            dbprintinsert("pkgpath","inspect.getdoc(pkgutil.iter_modules)","for a, b, c in pkgutil.iter_modules([pkgpath]):\n    print(f'{a} ; {b}; {c}')",env=g)(db)
            modules = [name for _, name, _ in pkgutil.iter_modules([pkgpath])]------------------------------------------------------------------------------(31)
            print(f'The library has {len(modules)} modules')------------------------------------------------------------------------------------------------(32)
            pprint(modules)---------------------------------------------------------------------------------------------------------------------------------(33)
    locals() keys: ['self', 'idxsrc', 'cmt', 'expand', 'showdbsrc', 'codes', 'src', 'dbsrc', 'indent', 'lst', 'newlst', 'i', 'srclines', 'idx', 'l', 'numindent', 'dbcodes', 'count', 'c', 'totallen', 'lenidx', 'dblst', 'idxsrcline', 'lenl']
    before update to exec, self.orisrc.__name__: whatinside is self.outenv['whatinside']: False
    exec on dbsrc above--------------------------------
    locals() keys: ['self', 'idxsrc', 'cmt', 'expand', 'showdbsrc', 'codes', 'src', 'dbsrc', 'indent', 'lst', 'newlst', 'i', 'srclines', 'idx', 'l', 'numindent', 'dbcodes', 'count', 'c', 'totallen', 'lenidx', 'dblst', 'idxsrcline', 'lenl', 'names', 'whatinside']
    self.orisrc.__name__: whatinside
    locals()['whatinside']: <function whatinside at 0x103fb2e50>
    after exec and before self.outenv update, self.outenv['whatinside'] is locals()['whatinside']: False
    after exec and before self.outenv update, self.orisrc.__name__: whatinside is self.outenv['whatinside']: False
    after exec and before self.outenv update, self.orisrc.__name__: whatinside is locals()['whatinside']: False
    after update self.outenv, self.orisrc.__name__: whatinside is self.outenv['whatinside']: False
    after update self.outenv, self.orisrc.__name__: whatinside is fastdebug.utils.whatinside: False
    after update self.outenv, self.outenv['whatinside'] is fastdebug.utils.whatinside: True
    Therefore, to use dbsrc we must use self.outenv['whatinside'], or fastdebug.utils.whatinside
    showdbsrc=End--------------------------------------
    fastdebug.utils has: 
    3 items in its __all__, and 
    9 user defined functions, 
    0 classes or class objects, 
    0 builtin funcs and methods, and
    9 callables.



                                                                                                pkgpath => pkgpath : /Users/Natsume/Documents/fastdebug/fastdebug


    inspect.getdoc(pkgutil.iter_modules) => inspect.getdoc(pkgutil.iter_modules) : Yields ModuleInfo for all submodules on path,
    or, if path is None, all top-level modules on sys.path.

    'path' should be either None or a list of paths to look for
    modules in.

    'prefix' is a string to output on the front of every module name
    on output.


    for a, b, c in pkgutil.iter_modules([pkgpath]):
        print(f'{a} ; {b}; {c}')                                                                                 
                                                                                                                                      Running your code block => 
    The code block printout => : 
    FileFinder('/Users/Natsume/Documents/fastdebug/fastdebug') ; _modidx; False
    FileFinder('/Users/Natsume/Documents/fastdebug/fastdebug') ; core; False
    FileFinder('/Users/Natsume/Documents/fastdebug/fastdebug') ; core0; False
    FileFinder('/Users/Natsume/Documents/fastdebug/fastdebug') ; utils; False
    The library has 4 modules
    ['_modidx', 'core', 'core0', 'utils']
        if clas: =============================================================================(20)      
            print(f'The class objects are:')==================================================(21)      
            pprint([i[0] for i in classes])===================================================(22)      
        if bltin: ============================================================================(23)      
            print(f'The builtin functions or methods are:')===================================(24)      
            pprint([i[0] for i in builtins])==================================================(25)      
        if cal: ==============================================================================(26)      
            print(f'The callables are: ')=====================================================(27)      
            pprint([i[0] for i in callables])=================================================(28)      
        if lib: ==============================================================================(29)      
            modules = [name for _, name, _ in pkgutil.iter_modules([pkgpath])]================(30) # get names of all modules of a lib
            print(f'The library has {len(modules)} modules')==================================(31)      
            pprint(modules)===================================================================(32)      
                                                                                                                                                            (33)
                                                                                                                                         part No.2 out of 2 parts

Now, let’s see the source code with all comments we made above. (After
running each cell, I can rewrite the comment to sum what I explored)

``` python
fdb.print()
```

    def whatinside(mo, # module, e.g., `import fastcore.all as fa`, use `fa` here=============(0)       
                   dun:bool=False, # print all items in __all__===============================(1)       
                   func:bool=False, # print all user defined functions========================(2)       
                   clas:bool=False, # print all class objects=================================(3)       
                   bltin:bool=False, # print all builtin funcs or methods=====================(4)       
                   lib:bool=False, # print all the modules of the library it belongs to=======(5)       
                   cal:bool=False # print all callables=======================================(6)       
                 ): ==========================================================================(7)       
        'Check what inside a module: `__all__`, functions, classes, builtins, and callables'==(8)       
        dun_all = len(mo.__all__) if hasattr(mo, "__all__") else 0============================(9) # count num in __all__
        funcs = inspect.getmembers(mo, inspect.isfunction)====================================(10) # get all funcs of a module
        classes = inspect.getmembers(mo, inspect.isclass)=====================================(11) # get all classes from the module
        builtins = inspect.getmembers(mo, inspect.isbuiltin)==================================(12)      
        callables = inspect.getmembers(mo, callable)==========================================(13)      
        pkgpath = os.path.dirname(mo.__file__)================================================(14) # get the file path of the module
        print(f"{mo.__name__} has: \n{dun_all} items in its __all__, and \n{len(funcs)} user defined functions, \n{len(classes)} classes or class objects, \n{len(builtins)} builtin funcs and methods, and\n{len(callables)} callables.\n")  (15)
        if hasattr(mo, "__all__") and dun: pprint(mo.__all__)=================================(16)      
        if func: =============================================================================(17)      
            print(f'The user defined functions are:')=========================================(18)      
            pprint([i[0] for i in funcs])=====================================================(19)      
        if clas: =============================================================================(20)      
            print(f'The class objects are:')==================================================(21)      
            pprint([i[0] for i in classes])===================================================(22)      
        if bltin: ============================================================================(23)      
            print(f'The builtin functions or methods are:')===================================(24)      
            pprint([i[0] for i in builtins])==================================================(25)      
        if cal: ==============================================================================(26)      
            print(f'The callables are: ')=====================================================(27)      
            pprint([i[0] for i in callables])=================================================(28)      
        if lib: ==============================================================================(29)      
            modules = [name for _, name, _ in pkgutil.iter_modules([pkgpath])]================(30) # get names of all modules of a lib
            print(f'The library has {len(modules)} modules')==================================(31)      
            pprint(modules)===================================================================(32)      
                                                                                                                                                            (33)

### Step 3: replace the db source with the original source code

To finish, I need to give
[`whatinside`](https://EmbraceLife.github.io/fastdebug/utils.html#whatinside)
its own untouched source code back

``` python
import inspect
```

``` python
test_eq(inspect.getsourcefile(whatinside.__globals__['whatinside']), '<string>')
test_eq(inspect.getsourcefile(fu.whatinside), '<string>')
test_eq(fu.whatinside is whatinside.__globals__['whatinside'], True)

test_eq(whatinside is whatinside.__globals__['whatinside'], False)
test_eq(whatinside is fu.whatinside, False)
test_eq(inspect.getsourcefile(whatinside), '/Users/Natsume/Documents/fastdebug/fastdebug/utils.py')
```

``` python
fdb.goback()
```

``` python
test_eq(inspect.getsourcefile(fu.whatinside), '/Users/Natsume/Documents/fastdebug/fastdebug/utils.py')
test_eq(fu.whatinside is whatinside.__globals__['whatinside'], True)
test_eq(whatinside is whatinside.__globals__['whatinside'], True)
test_eq(whatinside is fu.whatinside, True)
```

``` python
test_eq(inspect.getsourcefile(whatinside), '/Users/Natsume/Documents/fastdebug/fastdebug/utils.py')
```

To check, when run `whatinside??` we should see the actually source code
whereas the db version of
[`whatinside`](https://EmbraceLife.github.io/fastdebug/utils.html#whatinside)
does not have.

## Install

``` sh
pip install fastdebug
```

## How to use

Fill me in please! Don’t forget code examples:

``` python
1+1
```
